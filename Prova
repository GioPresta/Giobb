Trova questa sezione nel codice (verso la fine):

```python
if os.path.exists("temp.txt"):
    os.remove("temp.txt")

temp_files = glob.glob("tmp*.tmp") + glob.glob("tmp*")
for temp_file in temp_files:
    try:
        if os.path.exists(temp_file):
            os.remove(temp_file)
            print(f"Rimosso file temporaneo: {temp_file}")
    except:
        pass
```

**SOSTITUISCILA CON:**

```python
if os.path.exists("temp.txt"):
    os.remove("temp.txt")

# Aspetta che xlsxwriter rilasci tutti i file
import time
time.sleep(1)

# Rimuovi tutti i file tmp nella cartella corrente
temp_files = glob.glob("tmp*")  # Rimuovi .tmp per catturare tutto
for temp_file in temp_files:
    try:
        if os.path.isfile(temp_file) and temp_file.startswith("tmp"):
            os.remove(temp_file)
            print(f"Rimosso file temporaneo: {temp_file}")
    except Exception as e:
        print(f"Errore rimozione {temp_file}: {e}")
```

Questo dovrebbe rimuovere tutti e 3 i file tmp che si generano.