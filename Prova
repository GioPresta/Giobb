import pyautogui
import time

# Disabilita il fail-safe (muovi mouse in angolo per fermare)
# Commentalo se vuoi mantenere la sicurezza
# pyautogui.FAILSAFE = True

print("Script avviato. Premi Ctrl+C per fermare.")
print("Oppure muovi il mouse nell'angolo in alto a sinistra per attivare il fail-safe.")

try:
    while True:
        # Ottieni le dimensioni dello schermo
        larghezza, altezza = pyautogui.size()
        centro_x = larghezza // 2
        centro_y = altezza // 2
        
        # Muovi il mouse al centro dello schermo
        pyautogui.moveTo(centro_x, centro_y, duration=0.5)
        
        # Movimento su e giù leggero (10 pixel)
        pyautogui.moveRel(0, -10, duration=0.2)  # Su
        pyautogui.moveRel(0, 10, duration=0.2)   # Giù
        pyautogui.moveRel(0, -10, duration=0.2)  # Su
        pyautogui.moveRel(0, 10, duration=0.2)   # Giù
        
        # Click
        pyautogui.click()
        
        print(f"Movimento eseguito alle {time.strftime('%H:%M:%S')}")
        
        # Sospensione di 2 minuti (120 secondi)
        time.sleep(120)
        
except KeyboardInterrupt:
    print("\nScript fermato dall'utente.")
except Exception as e:
    print(f"\nErrore: {e}")