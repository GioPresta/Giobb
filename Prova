Perfetto! Quello che vuoi ottenere ora √®:


---

‚úÖ Logica definitiva aggiornata

Per ogni file .txt:

1. Trova la riga con LIVELLO.


2. Salta le 6 righe da LIVELLO incluso.


3. Salta anche le 4 righe successive.


4. Poi:

Salva tutto fino alla riga che inizia con ***.

Ignora tutte le righe fatte solo di trattini (es. ------).




> Nessuna riga di intestazione (LIVELLO) viene conservata.
Nessun trattino viene salvato.
Nessuna distinzione tra primo file e successivi.




---

üêç Script Python aggiornato

import os

def process_file(filepath):
    with open(filepath, 'r', encoding='latin-1') as f:
        lines = f.readlines()

    i = 0
    # Trova la riga con "LIVELLO"
    while i < len(lines):
        if 'LIVELLO' in lines[i]:
            break
        i += 1

    if i >= len(lines):
        return []  # LIVELLO non trovato

    # Salta: 6 righe (intestazione) + 4 righe successive = 10 righe totali
    i += 10
    output = []

    while i < len(lines):
        line = lines[i]
        if line.strip().startswith('***'):
            break
        # Ignora riga fatta solo di trattini
        if not set(line.strip()).issubset(set('-')):
            output.append(line)
        i += 1

    return output


def main():
    current_dir = os.path.dirname(os.path.abspath(__file__))
    output_filename = 'output_merged.txt'
    output_path = os.path.join(current_dir, output_filename)

    txt_files = [
        f for f in os.listdir(current_dir)
        if f.endswith('.txt') and f != output_filename
    ]
    txt_files.sort()

    merged_output = []
    for filename in txt_files:
        filepath = os.path.join(current_dir, filename)
        result = process_file(filepath)
        if result:
            merged_output.extend(result)
            merged_output.append('\n')  # Separatore tra blocchi

    with open(output_path, 'w', encoding='utf-8') as out_f:
        out_f.writelines(merged_output)

    print(f'‚úÖ File creato correttamente: {output_path}')


if __name__ == "__main__":
    main()


---

‚ú® Riepilogo finale del comportamento

Azione	Comportamento

Riga con LIVELLO	Salta, insieme alle 5 successive
4 righe dopo LIVELLO	Saltate
Righe con ------ (trattini)	Rimosse
Righe fino a ***	Salvate (escluso ***)
Riga ***	Ferma la copia (esclusa)
File di output (output_merged.txt)	Ignorato nei cicli



---

Fammi sapere se vuoi anche:

loggare i file che non contengono LIVELLO

includere la riga di asterischi nel blocco salvato


Lo script ora √® completamente coerente e pulito ‚úÖ
