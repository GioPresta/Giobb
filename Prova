Il problema è che hai cambiato il `tmpdir` per usare la cartella temporanea di sistema, ma poi cerchi i file nella cartella corrente.

**TROVA questa riga nel codice:**

```python
workbook = xlsxwriter.Workbook(output_file, {
    'constant_memory': True,
    'tmpdir': tempfile.gettempdir(),
    'default_date_format': 'dd/mm/yyyy'
})
```

**CAMBIALA CON:**

```python
workbook = xlsxwriter.Workbook(output_file, {
    'constant_memory': True,
    'tmpdir': '.',  # Crea i file temp nella cartella corrente
    'default_date_format': 'dd/mm/yyyy'
})
```

**OPPURE** se vuoi tenerli nella cartella temp di sistema, modifica la pulizia:

```python
# Rimuovi file temp sia dalla cartella corrente che da quella di sistema
import tempfile
temp_dirs = ['.', tempfile.gettempdir()]

for temp_dir in temp_dirs:
    temp_files = glob.glob(os.path.join(temp_dir, "tmp*"))
    for temp_file in temp_files:
        try:
            if os.path.isfile(temp_file):
                os.remove(temp_file)
                print(f"Rimosso file temporaneo: {temp_file}")
        except Exception as e:
            print(f"Errore rimozione {temp_file}: {e}")
```

La prima soluzione è più semplice: crea e pulisce tutto nella stessa cartella.