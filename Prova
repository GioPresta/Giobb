Certo! Ecco la versione semplificata e lineare dello script, scritta in modo chiaro, come se fosse stata fatta da un ragazzo che ha imparato Python da poco. Fa tutto quello che ti serve, ma senza strutture troppo complicate:


---

ðŸ§¾ Codice Python semplificato

import os
import re
import csv

# Per riconoscere dove inizia e finisce la tabella nei file
inizio_tabella = re.compile(r'^\s*LIVELLO\b', re.IGNORECASE)
fine_tabella = re.compile(r'^\s*\*{5,}\s*$')
riga_decorativa = re.compile(r'^[\s\-\*=_\.]{4,}$')

# Qui salvo intestazione e righe dei dati
intestazione = None
tutte_le_righe = []

# Prende tutti i file .txt nella cartella
for nome_file in os.listdir():
    if nome_file.endswith('.txt') and nome_file != 'riepilogo.txt':
        with open(nome_file, 'r', encoding='latin1') as file:
            dentro_tabella = False
            for riga in file:
                riga_pulita = riga.strip()

                if not dentro_tabella:
                    if inizio_tabella.match(riga_pulita):
                        if intestazione is None:
                            intestazione = riga_pulita
                        dentro_tabella = True
                else:
                    if fine_tabella.match(riga_pulita):
                        break
                    if not riga_decorativa.match(riga_pulita) and riga_pulita != intestazione:
                        tutte_le_righe.append(riga.strip())

# Scrive il file riepilogo.txt
with open('riepilogo.txt', 'w', encoding='utf-8') as txt_out:
    if intestazione:
        txt_out.write(intestazione + '\n')
    for r in tutte_le_righe:
        txt_out.write(r + '\n')

# Scrive anche un file CSV
with open('riepilogo.csv', 'w', encoding='utf-8', newline='') as csv_out:
    writer = csv.writer(csv_out, delimiter=';')
    if intestazione:
        colonne = re.split(r'\s{2,}', intestazione.strip())
        writer.writerow(colonne)
    for riga in tutte_le_righe:
        valori = re.split(r'\s{2,}', riga.strip())
        writer.writerow(valori)

print("âœ… Fatto! File riepilogo.txt e riepilogo.csv creati.")


---

ðŸ’¬ Cosa fa, in parole semplici:

1. Apre tutti i file .txt nella cartella


2. Prende solo le righe dalla scritta LIVELLO fino agli asterischi *****


3. Salta le righe piene di trattini o asterischi


4. Tiene solo una intestazione, quella del primo file


5. Unisce tutte le righe sotto quella intestazione


6. Scrive tutto in:

riepilogo.txt

riepilogo.csv per Excel





---

âœ… Nessuna dipendenza da installare

Questo script funziona con solo Python. Non serve pip install o altro.

Se vuoi che aggiunga la colonna col **nome

